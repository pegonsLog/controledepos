<div class="po-lista-container">
  <div class="header-controls">
    <h2>Lista de POs</h2>
    <mat-form-field appearance="outline" class="filter-field">
      <mat-label>Filtrar POs</mat-label>
      <input matInput (keyup)="applyFilter($event)" placeholder="Ex. PO-123 ou Analista">
      <mat-icon matSuffix>search</mat-icon>
    </mat-form-field>
  </div>

  <div class="table-responsive mat-elevation-z8">
    <table mat-table [dataSource]="dataSource" matSort>

      <!-- Coluna Número da PO -->
      <ng-container matColumnDef="numero_do_po">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Nº PO </th>
        <td mat-cell *matCellDef="let po"> {{po.numero_do_po}} </td>
      </ng-container>

      <!-- Coluna Data da PO -->
      <ng-container matColumnDef="data_po">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Data PO </th>
        <td mat-cell *matCellDef="let po"> {{po.data_po | date:'dd/MM/yyyy'}} </td>
      </ng-container>

      <!-- Coluna Situação -->
      <ng-container matColumnDef="situacao">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Situação </th>
        <td mat-cell *matCellDef="let po"> {{po.situacao}} </td>
      </ng-container>

      <!-- Coluna Analista -->
      <ng-container matColumnDef="analista">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Analista </th>
        <td mat-cell *matCellDef="let po"> {{po.analista}} </td>
      </ng-container>

      <!-- Coluna Solicitante -->
      <ng-container matColumnDef="solicitante">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Solicitante </th>
        <td mat-cell *matCellDef="let po"> {{po.solicitante}} </td>
      </ng-container>

      <!-- Coluna Tipo de Solicitante -->
      <ng-container matColumnDef="tipo_de_solicitante">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo Solicitante </th>
        <td mat-cell *matCellDef="let po"> {{po.tipo_de_solicitante}} </td>
      </ng-container>

      <!-- Coluna Bairro -->
      <ng-container matColumnDef="bairro">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Bairro </th>
        <td mat-cell *matCellDef="let po"> {{po.bairro}} </td>
      </ng-container>

      <!-- Coluna Tipo de Logradouro -->
      <ng-container matColumnDef="tipo_de_logradouro">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo Logradouro </th>
        <td mat-cell *matCellDef="let po"> {{po.tipo_de_logradouro}} </td>
      </ng-container>

      <!-- Coluna Logradouro -->
      <ng-container matColumnDef="logradouro">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Logradouro </th>
        <td mat-cell *matCellDef="let po"> {{po.logradouro}} </td>
      </ng-container>

      <!-- Coluna Complemento do Logradouro -->
      <ng-container matColumnDef="complemento_do_logradouro">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Complemento </th>
        <td mat-cell *matCellDef="let po"> {{po.complemento_do_logradouro}} </td>
      </ng-container>

      <!-- Coluna Data de Implantação -->
      <ng-container matColumnDef="data_implantacao">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Data Implantação </th>
        <td mat-cell *matCellDef="let po"> {{po.data_implantacao | date:'dd/MM/yyyy'}} </td>
      </ng-container>

      <!-- Coluna Funcionário Responsável -->
      <ng-container matColumnDef="funcionario_responsavel">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Funcionário Resp. </th>
        <td mat-cell *matCellDef="let po"> {{po.funcionario_responsavel}} </td>
      </ng-container>

      <!-- Coluna Observações -->
      <ng-container matColumnDef="observacoes">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Observações </th>
        <td mat-cell *matCellDef="let po"> {{po.observacoes}} </td>
      </ng-container>

      <!-- Coluna Especificações -->
      <ng-container matColumnDef="especificacoes">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Especificações </th>
        <td mat-cell *matCellDef="let po"> {{po.especificacoes}} </td>
      </ng-container>

      <!-- Coluna E-mail -->
      <ng-container matColumnDef="e_mail">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> E-mail </th>
        <td mat-cell *matCellDef="let po"> {{po.e_mail}} </td>
      </ng-container>

      <!-- Coluna Data Encerramento DRO -->
      <ng-container matColumnDef="data_enc_dro">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Data Enc. DRO </th>
        <td mat-cell *matCellDef="let po"> {{po.data_enc_dro | date:'dd/MM/yyyy'}} </td>
      </ng-container>

      <!-- Coluna Link da PO -->
      <ng-container matColumnDef="link_do_po">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Link PO </th>
        <td mat-cell *matCellDef="let po">
          <a *ngIf="po.link_do_po" [href]="po.link_do_po" target="_blank" matTooltip="Abrir link da PO">Link</a>
          <span *ngIf="!po.link_do_po">-</span>
        </td>
      </ng-container>

      <!-- Coluna Número de Controle -->
      <ng-container matColumnDef="numero_de_controle">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Nº Controle </th>
        <td mat-cell *matCellDef="let po"> {{po.numero_de_controle}} </td>
      </ng-container>

      <!-- Coluna Data de Arquivamento -->
      <ng-container matColumnDef="data_arquivamento">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Data Arquivamento </th>
        <td mat-cell *matCellDef="let po"> {{po.data_arquivamento | date:'dd/MM/yyyy'}} </td>
      </ng-container>

      <!-- Coluna Criado Em -->
      <ng-container matColumnDef="criado_em">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Criado Em </th>
        <td mat-cell *matCellDef="let po"> {{po.criado_em | date:'dd/MM/yyyy HH:mm'}} </td>
      </ng-container>

      <!-- Coluna Última Edição -->
      <ng-container matColumnDef="ultima_edicao">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Última Edição </th>
        <td mat-cell *matCellDef="let po"> {{po.ultima_edicao | date:'dd/MM/yyyy HH:mm'}} </td>
      </ng-container>

      <!-- Coluna Ações -->
      <ng-container matColumnDef="acoes">
        <th mat-header-cell *matHeaderCellDef> Ações </th>
        <td mat-cell *matCellDef="let po">
          <button mat-icon-button color="primary" (click)="visualizarPo(po)" matTooltip="Visualizar">
            <mat-icon>visibility</mat-icon>
          </button>
          <button mat-icon-button color="accent" (click)="editarPo(po)" matTooltip="Editar">
            <mat-icon>edit</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" [attr.colspan]="displayedColumns.length">
          Nenhum dado encontrado para "{{dataSource.filter}}".
        </td>
      </tr>
    </table>
  </div>

  <div class="paginator-container">
    <span class="total-registros">Registros encontrados: {{totalRegistros}} (de {{dataSource.data.length}})</span>
    <mat-paginator [pageSizeOptions]="[5, 10, 20, 50]"
                   [pageSize]="10"
                   showFirstLastButtons
                   aria-label="Selecione a página de POs">
    </mat-paginator>
  </div>
</div>
